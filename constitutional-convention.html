<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constitutional Convention 1787 - Interactive Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 50%, #7986cb 100%);
            color: #1a1a1a;
            line-height: 1.8;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, #0d1b4d 0%, #1a237e 100%);
            color: #f4e4c1;
            padding: 40px 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            border: 3px solid #d4af37;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: #d4af37;
        }

        .subtitle {
            font-size: 1.3em;
            font-style: italic;
            color: #f4e4c1;
            margin-top: 10px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 15px 25px;
            background: #f4e4c1;
            border: 3px solid #1a237e;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            color: #1a237e;
            font-family: 'Georgia', serif;
        }

        .tab-button:hover:not(:disabled) {
            background: #d4af37;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .tab-button.active {
            background: #1a237e;
            color: #f4e4c1;
            border-color: #d4af37;
        }

        .tab-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .content-section {
            display: none;
            background: #f4e4c1;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            border: 3px solid #1a237e;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .parchment-box {
            background: #faf8f3;
            padding: 25px;
            border-left: 5px solid #1a237e;
            margin: 20px 0;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .delegate-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .delegate-card {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .delegate-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
            border-color: #1a237e;
        }

        .delegate-card.selected {
            border-color: #d4af37;
            background: #fff9e6;
        }

        .delegate-card h3 {
            color: #1a237e;
            margin-bottom: 10px;
            font-size: 1.4em;
        }

        .delegate-role {
            color: #d4af37;
            font-style: italic;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .speech-box {
            background: #fff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #d4af37;
        }

        .speaker-name {
            font-weight: bold;
            color: #1a237e;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
            font-family: 'Georgia', serif;
        }

        .btn-primary {
            background: #1a237e;
            color: #f4e4c1;
        }

        .btn-primary:hover {
            background: #0d1b4d;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .btn-success {
            background: #2d5016;
            color: #f4e4c1;
        }

        .btn-danger {
            background: #8b0000;
            color: #f4e4c1;
        }

        .choice-button {
            display: block;
            width: 100%;
            text-align: left;
            padding: 20px;
            margin: 15px 0;
            background: #fff;
            border: 3px solid #1a237e;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.05em;
        }

        .choice-button:hover {
            background: #e8f4f8;
            border-color: #d4af37;
            transform: translateX(5px);
        }

        .choice-button.selected {
            background: #d4e8d4;
            border-color: #2d5016;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-family: 'Georgia', serif;
            font-size: 1em;
            resize: vertical;
        }

        .word-count {
            text-align: right;
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .word-count.sufficient {
            color: #2d5016;
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background: #f4e4c1;
            padding: 40px;
            border-radius: 10px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 4px solid #1a237e;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2em;
            cursor: pointer;
            color: #1a237e;
            background: none;
            border: none;
        }

        .crisis-banner {
            background: #8b0000;
            color: #f4e4c1;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            border: 3px solid #d4af37;
        }

        .warning-banner {
            background: #ff8c00;
            color: #fff;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 5px solid #8b0000;
        }

        .success-banner {
            background: #2d5016;
            color: #f4e4c1;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 5px solid #d4af37;
        }

        .progress-tracker {
            background: #1a237e;
            color: #f4e4c1;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .progress-item {
            padding: 5px 15px;
            margin: 5px;
            border-radius: 3px;
            background: rgba(244, 228, 193, 0.2);
        }

        .progress-item.completed {
            background: #2d5016;
        }

        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #1a237e;
            border-radius: 5px;
            font-family: 'Georgia', serif;
            font-size: 1em;
            margin: 10px 0;
        }

        .parliamentary-note {
            background: #e8f4f8;
            border-left: 4px solid #1a237e;
            padding: 15px;
            margin: 15px 0;
            font-style: italic;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .delegate-grid {
                grid-template-columns: 1fr;
            }
            
            .tab-button {
                padding: 12px 15px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèõÔ∏è The Constitutional Convention üèõÔ∏è</h1>
            <p class="subtitle">Philadelphia, Summer of 1787</p>
            <p style="margin-top: 15px; font-size: 0.95em;">An Interactive Simulation of America's Founding</p>
        </header>

        <div class="progress-tracker" id="progress-tracker" style="display: none;">
            <div class="progress-item" id="progress-intro">Introduction</div>
            <div class="progress-item" id="progress-delegate">Delegate Selection</div>
            <div class="progress-item" id="progress-debate1">Representation</div>
            <div class="progress-item" id="progress-debate2">Federal Power</div>
            <div class="progress-item" id="progress-debate3">Democracy</div>
            <div class="progress-item" id="progress-debate4">Bill of Rights</div>
            <div class="progress-item" id="progress-debate5">Slavery</div>
            <div class="progress-item" id="progress-final">Final Reflection</div>
        </div>

        <div class="nav-tabs" id="nav-tabs">
            <button class="tab-button active" onclick="showTab('intro')">Introduction</button>
            <button class="tab-button" onclick="showTab('delegates')" id="tab-delegates" disabled>Choose Delegate</button>
            <button class="tab-button" onclick="showTab('debate1')" id="tab-debate1" disabled>Debate 1</button>
            <button class="tab-button" onclick="showTab('debate2')" id="tab-debate2" disabled>Debate 2</button>
            <button class="tab-button" onclick="showTab('debate3')" id="tab-debate3" disabled>Debate 3</button>
            <button class="tab-button" onclick="showTab('debate4')" id="tab-debate4" disabled>Debate 4</button>
            <button class="tab-button" onclick="showTab('debate5')" id="tab-debate5" disabled>Debate 5</button>
            <button class="tab-button" onclick="showTab('final-reflection')" id="tab-final" disabled>Final Reflection</button>
            <button class="tab-button" onclick="showTab('submit')" id="tab-submit" disabled>Submit Work</button>
            <button class="tab-button" onclick="showTab('reveal')" id="tab-reveal" disabled>Historical Reveal</button>
        </div>

        <!-- INTRODUCTION -->
        <div id="intro" class="content-section active">
            <h2>Welcome to the Constitutional Convention</h2>
            
            <div class="parchment-box">
                <h3>The Crisis of 1787</h3>
                <p>The year is 1787. The American Revolution has been won, but the young nation teeters on the brink of collapse. Under the Articles of Confederation, the United States is little more than a loose alliance of thirteen squabbling states.</p>
                
                <p style="margin-top: 15px;">Congress cannot collect taxes. It cannot regulate trade between states. It cannot enforce treaties. State currencies compete, creating economic chaos. Some states impose tariffs on goods from neighboring states. The national government is so weak it cannot even suppress rebellions like Shays' Rebellion in Massachusetts.</p>
                
                <p style="margin-top: 15px;">Fifty-five delegates from twelve states have gathered in Philadelphia this hot summer. Rhode Island has refused to send anyone. Your mission: to create a new framework of government strong enough to unite the states, yet balanced enough to preserve liberty.</p>
            </div>

            <div class="parchment-box">
                <h3>Your Role in History</h3>
                <p>In this simulation, you will take on the role of one of the Founding Fathers. You will participate in five critical debates that shaped the Constitution:</p>
                <ul style="margin-left: 30px; margin-top: 10px;">
                    <li><strong>Representation:</strong> Should Congress represent states equally or by population?</li>
                    <li><strong>Federal Power:</strong> How much authority should the national government have over the states?</li>
                    <li><strong>Democracy:</strong> How much power should the people have directly vs. through elected representatives?</li>
                    <li><strong>Rights:</strong> Does the Constitution need a Bill of Rights?</li>
                    <li><strong>Slavery:</strong> What should the Constitution say about slavery and the slave trade?</li>
                </ul>
            </div>

            <div class="parchment-box">
                <h3>Parliamentary Procedure</h3>
                <p>The Convention operates under formal rules of decorum and procedure:</p>
                <ul style="margin-left: 30px; margin-top: 10px;">
                    <li>George Washington presides as Convention President</li>
                    <li>Delegates must be recognized before speaking</li>
                    <li>Address others as "The Honorable Delegate from [State]" or "Mr. [Name]"</li>
                    <li>All motions must be seconded before debate</li>
                    <li>Maintain respectful discourse at all times</li>
                </ul>
                <p style="margin-top: 15px; font-style: italic;">Violations of decorum will not be tolerated in this assembly.</p>
            </div>

            <div class="parchment-box">
                <h3>Your Mission</h3>
                <p><strong>As a delegate, you must:</strong></p>
                <ul style="margin-left: 30px; margin-top: 10px;">
                    <li>Stay true to your historical character's positions (or justify deviations)</li>
                    <li>Listen to full debate speeches before making choices</li>
                    <li>Reflect on the democratic norms and compromises you observe</li>
                    <li>Help create a Constitution that can actually be ratified</li>
                </ul>
                
                <p style="margin-top: 15px;"><strong>Remember:</strong> Extreme positions may cause the Convention to fail. You may need to compromise to save the Union. But some compromises may haunt the nation for generations to come.</p>
            </div>

            <div class="parchment-box">
                <h3>Student Information</h3>
                <label for="student-name"><strong>Your Name:</strong></label>
                <input type="text" id="student-name" placeholder="Enter your full name">
                
                <label for="student-email" style="display: block; margin-top: 15px;"><strong>Your Email:</strong></label>
                <input type="text" id="student-email" placeholder="your.name@my.yosemite.edu">
            </div>

            <button class="btn btn-primary" onclick="startConvention()">Begin the Convention ‚Üí</button>
        </div>

        <!-- DELEGATE SELECTION -->
        <div id="delegates" class="content-section">
            <h2>Choose Your Delegate</h2>
            
            <div class="parchment-box">
                <p>You will role-play as one of the Founding Fathers throughout this simulation. Each delegate has distinct views and positions. Read their biographies carefully, then choose who you wish to represent.</p>
                <p style="margin-top: 10px; font-weight: bold; color: #8b0000;">Remember: You should try to stay consistent with your delegate's historical positions, but you may deviate if you can justify your reasoning.</p>
            </div>

            <div class="delegate-grid" id="delegate-grid">
                <!-- Delegates will be populated by JavaScript -->
            </div>

            <button class="btn btn-primary" onclick="confirmDelegate()" id="confirm-delegate-btn" style="display: none; margin-top: 20px;">Confirm Selection & Proceed ‚Üí</button>
        </div>

        <!-- DEBATE 1: REPRESENTATION -->
        <div id="debate1" class="content-section">
            <h2>Debate 1: Representation - By State or by Population?</h2>
            
            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington calls the Convention to order</strong><br>
                "Gentlemen, we shall now consider the question of representation in the proposed Congress. The clerk will read the motion."
            </div>

            <div class="parchment-box">
                <h3>The Question Before the Convention</h3>
                <p>Under the Articles of Confederation, each state has one vote in Congress, regardless of population. Virginia has nearly 750,000 people; Delaware has 59,000. Yet both have equal say.</p>
                
                <p style="margin-top: 15px;">Should the new Congress continue this arrangement? Or should representation be based on population, giving larger states more power?</p>
                
                <p style="margin-top: 15px; font-weight: bold;">This question threatens to tear apart the Convention before it even begins.</p>
            </div>

            <h3 style="margin-top: 30px;">The Debate</h3>
            
            <div class="speech-box">
                <div class="speaker-name">Mr. Madison of Virginia:</div>
                <p>The equality of suffrage established by the Articles of Confederation ought not to prevail in the national Legislature, and an equal ratio of representation based on population ought to be substituted.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Read of Delaware:</div>
                <p>I move that the whole motion on the question of representation be postponed. May I take this opportunity to remind the convention that the delegates from Delaware received explicit orders from the state not to allow any changes in the method of representation? If such a change is made and agreed upon, Delaware may have to leave the Convention.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Madison of Virginia:</div>
                <p>Whatever reason there may have been for equal votes by states under the Articles of Confederation, it must change with the creation of a national government. Under the Articles, the Congress depended completely upon the states to carry out its laws. With the new government we intend to create, however, it would not be fair for the small states to have as much say as the large ones.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Morris of Pennsylvania:</div>
                <p>It would be of great concern to me if Delaware would withdraw her valuable assistance in writing the Constitution. The question of representation is too important to be buried, however. We must decide this question.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Brearly of New Jersey:</div>
                <p>I am sorry that anyone would want to change the arrangement we have under the Articles of Confederation. This issue had already been discussed for far too long when we wrote the Articles. Perhaps some of you don't remember, but we decided at the time that each state is equal and independent ‚Äî and that equal states should have equal votes. Let us be wise enough not to change a decision made after much consideration.</p>
                
                <p style="margin-top: 15px;">At first glance it may seem fair to give votes to states on the basis of their population; but stop to think about this for a minute. Would it be fair to give Virginia 16 votes and Georgia only one? Would it be fair to give three large states, and you all know who they are, more votes than the rest of the country together?</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. King of Massachusetts:</div>
                <p>I am really astonished to hear you. You are ready to sack our great plan for proportional representation because of the single folly of these phantoms you call states? A government based on your principles of states' rights would be as short-lived as it is unjust.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Paterson of New Jersey:</div>
                <p>I quite agree with my colleague from New Jersey. Proportionate representation would ruin the smaller states ‚Äî it would make them powerless. Furthermore, this idea would go beyond the powers given to us as convention delegates. May I remind those who would destroy the Confederacy that we came here to amend it, not to write a new constitution. We don't want to open ourselves to charges that we are going beyond our authority. Our instructions reflect the opinions of the people within each state. These people did not send us to Philadelphia to set up a national government. We came here representing an alliance of equal states and we must leave here representing that alliance. Thus, let us stick with the plan of giving each state one vote, as in the Articles. Let us not go beyond that. We must follow what the people want, and the people want a confederation of states, not a single nation. It is not up to the people to follow what we want.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. King of Massachusetts:</div>
                <p>I don't know what you are talking about. You are talking about these states as if they were separate bits of real estate. They are not self-governing. They do not possess the attributes of self-government. They are dumb, for they can't speak to foreign countries; they are deaf, for they can't hear and receive ambassadors from foreign countries. They cannot defend themselves in war. They only exist because they are part of a Union of States. And this Union is now deciding what to do about itself and the states that have no real existence without it.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Martin of Maryland:</div>
                <p>I most heartily disagree. When we separated from England, we became thirteen independent states, in a state of nature toward each other. We would have remained in that state till this time but for forming a government under the Articles of Confederation. We entered into that confederation on a footing of equality. We are now meeting to amend the Articles of Confederation on the same footing that we are all equal to each other. I will never give in to a plan that would put ten states at the mercy of Virginia, Massachusetts, and Pennsylvania.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>There is not much hope left for this confederacy. We aren't even able to collect our taxes. When it finally falls apart, some of the states are going to have to unite for their own safety and we hope New Jersey will join us. If she decides not to, good luck to her, but join together we will, with or without New Jersey.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Paterson of New Jersey:</div>
                <p>There is no more reason that an individual state contributing much should have more votes than a small state contributing little, than that a rich citizen should have more votes than a poor citizen.</p>
                
                <p style="margin-top: 15px;">If you make the mistake of giving the large states an influence in proportion to their size, what will be the results? I'll tell you what the results would be. Their ambitions will be increased and the small states will have everything to fear.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>Some people don't really believe in equality. They don't understand that governments are based on the consent of the people. The people are supreme. They are worth more than an artificial set of boundaries called New Jersey or Pennsylvania.</p>
                
                <p style="margin-top: 15px;">It stands to reason that equal numbers of people should have equal representation and different numbers of people should have different representation. It is true that this principle was violated in the Articles of Confederation ‚Äî but there was a war going on at the time the Articles were written. We did not have the time to hammer out this principle of equality over the objections of some of the smaller states that were selfishly defending their interests. We have the time now and we must make the right decision.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Dickinson of Delaware:</div>
                <p>We would sooner admit to a foreign country than submit to be deprived of an equality of suffrage in both branches of the legislature, and be thrown under the domination of the large states.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>The honorable delegate tells us from Delaware that each state is sovereign because it rules over its own people. And we are told that all the sovereign states are equal. But all states are composed of people who rule over themselves. These sovereign people are equals. They must retain that equality when it comes time for them to choose the men who will represent them in government. Equal numbers of people must be entitled to equal numbers of delegates.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Paterson of New Jersey:</div>
                <p>I will oppose any plan for proportionate representation. I will oppose it here; I will oppose it when I get back to New Jersey; I will oppose it as long as there is breath in my body to fight against the scheme.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>Let us not hear any more talk of refusing to go along with the Convention. If New Jersey will not part with her sovereignty, we cannot talk about government.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Dr. Franklin of Pennsylvania:</div>
                <p>The diversity of opinions turns on two points. If a proportional representation takes place, the small states believe that their liberties will be in danger. If an equality of votes is to be put in its place, the large states say their money will be in danger.</p>
                
                <p style="margin-top: 15px;">Gentlemen, we seem to have reached a stalemate, but I have a solution to our problem.</p>
                
                <p style="margin-top: 15px;">When a broad table is to be made, and the edges do not fit, the carpenter takes a little from both sides and makes a good joint. In like manner here both sides must part with some of their demands, in order that they may join in some accommodating proposition.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Sherman of Connecticut:</div>
                <p>Mr. Franklin, you are quite right. It seems logical that some sort of compromise must be worked out. Why not have a legislature consisting of two houses of Congress? In the first branch, the vote can be given to states according to their population, and in the second branch, each state can have the same number of votes. This way the small states would be able to protect themselves from the few large states that otherwise would rule the rest. This would be very similar to England, where the House of Lords has an equal vote in government with the House of Commons so that it can protect its rights.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Rutledge of South Carolina:</div>
                <p>The proportion of votes in the first branch should be based on the monetary contribution of each state to the country as a whole. The justice of this rule cannot be denied. We all know that money is power, and the states should have a say in government in proportion to their wealth.</p>
            </div>

            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "Gentlemen, the debate has been vigorous. The chair now recognizes <span id="debate1-your-name">the delegate</span> to present their position on this matter."
            </div>

            <h3 style="margin-top: 30px;">Your Position</h3>
            <div class="parchment-box">
                <p><strong>As <span id="debate1-delegate-name">your delegate</span>, what position will you take?</strong></p>
                <p style="margin-top: 10px; font-style: italic; color: #666;">Choose carefully. Extreme positions may trigger a crisis that threatens the Convention.</p>
            </div>

            <button class="choice-button" onclick="makeChoice('debate1', 'population', 'Each state in Congress should have representation in proportion to population.')">
                <strong>Representation by Population Only</strong><br>
                <span style="font-size: 0.9em;">Each state should have votes in Congress based on its population. Larger states deserve more power because they have more people.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate1', 'states', 'Each state in Congress should have one vote.')">
                <strong>Equal State Representation</strong><br>
                <span style="font-size: 0.9em;">Each state should have one vote in Congress, just as under the Articles of Confederation. States are sovereign and equal.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate1', 'compromise', 'Congress should have two houses: one with representation by population, one with equal state votes.')">
                <strong>The Connecticut Compromise</strong><br>
                <span style="font-size: 0.9em;">Create two houses of Congress - a House of Representatives based on population, and a Senate with equal state representation.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate1', 'wealth', 'Representation should be based on each state\\'s financial contribution to the nation.')">
                <strong>Representation by Wealth</strong><br>
                <span style="font-size: 0.9em;">States should have representation based on their tax contributions and wealth, not just population.</span>
            </button>

            <div id="debate1-reflection" style="display: none; margin-top: 30px;">
                <div class="parchment-box">
                    <h3>Reflection on the Representation Debate</h3>
                    <p><strong>Before proceeding to the next debate, reflect on what you just experienced. Write at least 200 words addressing these questions:</strong></p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>What parliamentary procedures did you observe in this debate?</li>
                        <li>How did delegates demonstrate respect (or disrespect) for democratic norms?</li>
                        <li>What compromise strategies were most effective?</li>
                        <li>Why was this issue so contentious?</li>
                    </ul>
                    
                    <textarea id="debate1-reflection-text" oninput="updateWordCount('debate1-reflection-text', 'debate1-word-count')"></textarea>
                    <div class="word-count" id="debate1-word-count">Word count: 0 / 200 minimum</div>
                </div>
                
                <button class="btn btn-primary" onclick="completeDebate('debate1')">Continue to Next Debate ‚Üí</button>
            </div>
        </div>

        <!-- DEBATE 2: FEDERAL POWER -->
        <div id="debate2" class="content-section">
            <h2>Debate 2: Local Control vs. National Authority</h2>
            
            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "The Convention will come to order. We shall now deliberate upon the extent of powers to be granted to the national government."
            </div>

            <div class="parchment-box">
                <h3>The Question Before the Convention</h3>
                <p>The Founders agree that the national government needs more power than it had under the Articles. But how much power? Should the national government be supreme over the states, or should it only have limited, specific powers?</p>
                
                <p style="margin-top: 15px;">Some delegates want the national government to have the power to veto state laws. Others fear this would destroy the states entirely.</p>
            </div>

            <h3 style="margin-top: 30px;">The Debate</h3>

            <div class="speech-box">
                <div class="speaker-name">Colonel Hamilton of New York:</div>
                <p>Two equal sovereign states cannot exist within the same boundaries. You cannot give powers to two governments over the same people. If you give powers to Congress and to the states, you will have either a bad (I should say two bad) governments or no government at all. What is to be done? I hardly dare tell you because I am afraid that we do not yet have the courage to face the issue squarely. I am afraid that I might shock you and the public. But I must speak.</p>
                
                <p style="margin-top: 15px;">There is no reason to keep state governments the way we have them today. They are not necessary for any great purpose ‚Äî neither for agriculture, commerce, revenue, or defense. Yes, they are necessary to administer laws, but not to make them. The states need not continue to have any great authority. We can all but abolish them and have one government for all the people of the country ‚Äî one national government with states as administrative lines or jurisdictions for carrying out the laws, which will be made equally for all the people. I hope I have not shocked you too much.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Mason of Virginia:</div>
                <p>I agree with the distinguished Colonel Hamilton of New York. We need a national government. But that does not mean we must abolish the state governments or make them absolutely insignificant. The states are as necessary as the national government and we must be careful to preserve them.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>The danger, my friends, is not that the national government will swallow the states, but that the states will swallow the national government. If the national government were to extend its power, the people would be no less free for it. A citizen of Delaware is not freer than a citizen of Virginia; nor would either be freer than a citizen of America. So no fatal consequence would result if the national government were to absorb the state governments.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Martin of Maryland:</div>
                <p>Mason is absolutely right about the importance of the state governments. I would never consent to Colonel Hamilton's plan, and I understand it too well. We are making the national government stronger to protect the states. Let us not lose sight of that object.</p>
                
                <p style="margin-top: 15px;">When we separated from England, the American people decided to establish thirteen separate state governments instead of one national government. To these states they look for the safety of their lives, liberties, and properties. They formed the national government to defend the states against foreign nations in case of war, and to defend the smaller states against the ambitious designs of the larger states. If we grant unnecessary power to the national government, we will defeat the original purpose of the Union.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Madison of Virginia:</div>
                <p>I consider the veto on the laws of the states as essential to the security of the national government. The necessity of the national government rises from the desire of the states to follow their particular interests in opposition to the national interests. This desire will continue to disturb the system unless it is effectively controlled. Nothing short of a veto on state laws will control it.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Sherman of Connecticut:</div>
                <p>The whole thing is ridiculous. State courts will protect the authority of the Union. They will do the job of negating any state law that the national government would wish to veto.</p>
            </div>

            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "The delegate <span id="debate2-your-name">from your state</span> is recognized. How say you on this matter of national versus state authority?"
            </div>

            <h3 style="margin-top: 30px;">Your Position</h3>
            <div class="parchment-box">
                <p><strong>As <span id="debate2-delegate-name">your delegate</span>, what position will you take on the balance of power?</strong></p>
            </div>

            <button class="choice-button" onclick="makeChoice('debate2', 'national-supreme', 'The national government should have supreme power, including the right to veto state laws.')">
                <strong>National Government Supreme</strong><br>
                <span style="font-size: 0.9em;">The national government should have unlimited authority and the power to veto any state law that contradicts national policy.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate2', 'states-primary', 'State governments should retain most powers; national government should only handle defense and foreign affairs.')">
                <strong>States Retain Primary Power</strong><br>
                <span style="font-size: 0.9em;">The national government should only handle matters clearly concerning all states (war, treaties, trade between states). States should handle everything else.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate2', 'balanced', 'Create a system where both national and state governments have defined spheres of authority.')">
                <strong>Balanced Federal System</strong><br>
                <span style="font-size: 0.9em;">Divide powers clearly: national government handles issues affecting the whole nation, states handle local matters. Make national law supreme, but limit national government to specific enumerated powers.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate2', 'limited-veto', 'Give Congress limited veto power over state laws that clearly violate the Constitution.')">
                <strong>Limited National Veto</strong><br>
                <span style="font-size: 0.9em;">Allow the national government to veto state laws, but only when those laws clearly contradict the Constitution or treaties.</span>
            </button>

            <div id="debate2-reflection" style="display: none; margin-top: 30px;">
                <div class="parchment-box">
                    <h3>Reflection on Federal Power</h3>
                    <p><strong>Reflect on this debate (minimum 200 words):</strong></p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>What were the main fears expressed about strong national government?</li>
                        <li>What were the main fears about weak national government?</li>
                        <li>How did delegates balance these competing concerns?</li>
                        <li>What role did compromise play in this debate?</li>
                    </ul>
                    
                    <textarea id="debate2-reflection-text" oninput="updateWordCount('debate2-reflection-text', 'debate2-word-count')"></textarea>
                    <div class="word-count" id="debate2-word-count">Word count: 0 / 200 minimum</div>
                </div>
                
                <button class="btn btn-primary" onclick="completeDebate('debate2')">Continue to Next Debate ‚Üí</button>
            </div>
        </div>

        <!-- DEBATE 3: DEMOCRACY -->
        <div id="debate3" class="content-section">
            <h2>Debate 3: Majority Rule vs. Checks and Balances</h2>
            
            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "Gentlemen, we shall now address the delicate question of democracy and the role of the people in this new government."
            </div>

            <div class="parchment-box">
                <h3>The Question Before the Convention</h3>
                <p>How democratic should the new government be? Should the people elect their leaders directly, or should educated electors make those choices? How long should terms be? Can officials be removed?</p>
                
                <p style="margin-top: 15px;">Many delegates fear "too much democracy" and want checks on the power of the majority. Others trust the people more than they trust any other source of authority.</p>
            </div>

            <h3 style="margin-top: 30px;">The Debate</h3>

            <div class="speech-box">
                <div class="speaker-name">Mr. Madison of Virginia:</div>
                <p>How long should we allow senators to hold office? In answering this question, we must consider the purpose of the senate. This is first to protect the people against their rulers, and second to protect the people against their own foolishness. An obvious precaution against this danger would be to divide the trust between different bodies of men who would be elected at different times and thus be able to watch and check each other.</p>
                
                <p style="margin-top: 15px;">In all civilized countries, the people fall into different classes having a real or supposed difference of interests. Most particularly there will be distinctions between the rich and the poor. An increase of population over the ages will increase the number of those who labor under all the hardships of life. These may in time outnumber those who are placed above the feelings of comfort. According to the equal laws of voting, the power will slide into the hands of the poor.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Colonel Hamilton of New York:</div>
                <p>Gentlemen, may I speak frankly to you? I fear democracy and representative government. The British have the wisest and best government in the world: one that unites public strength and individual security.</p>
                
                <p style="margin-top: 15px;">In every community, there will be divisions between the few and the many. Hence, separate interests will arise. There will be debtors and creditors, rich and poor. If we give all power to the rich, they will oppress the poor. Both, therefore, must have power to defend themselves against the other.</p>
                
                <p style="margin-top: 15px;">The British House of Lords is a most noble institution. Because they have nothing to gain from change, they form a permanent barrier against every foolish plan. We need a permanent body of men who will serve in the senate for life, like the Lords.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Gerry of Massachusetts:</div>
                <p>The evils we experience flow from the excess of democracy. The people do not lack virtue, but are the dupes of pretended patriots. In Massachusetts, it has been fully confirmed by experience that they are daily misled into the most wicked measures and opinions by false reports circulated by designing men.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Sherman of Connecticut:</div>
                <p>The people should have as little to do as may be about the government. They lack information and are constantly misled.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Dr. Franklin of Pennsylvania:</div>
                <p>We should not underestimate the honesty and public spirit of our common people. They displayed a great deal of it during the war and contributed principally to winning it. I think we can trust the common man in America to vote intelligently and not sell his vote.</p>
                
                <p style="margin-top: 15px;">I am persuaded also that such restrictions as were proposed would give great cause for concern in the states. The sons of a substantial farmer, not being themselves freeholders, would not be pleased at being disfranchised, and there are a great many persons of that description.</p>
            </div>

            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "The chair recognizes <span id="debate3-your-name">the delegate</span> to present their views on the question of democracy and representation."
            </div>

            <h3 style="margin-top: 30px;">Your Position</h3>
            <div class="parchment-box">
                <p><strong>As <span id="debate3-delegate-name">your delegate</span>, how democratic should the new government be?</strong></p>
            </div>

            <button class="choice-button" onclick="makeChoice('debate3', 'full-democracy', 'The people should directly elect all officials with frequent elections.')">
                <strong>Strong Democratic System</strong><br>
                <span style="font-size: 0.9em;">Trust the people. Allow all free men to vote. Have the people elect Representatives (2 years), Senators (4 years), and the President (4 years) directly.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate3', 'aristocratic', 'Only property owners should vote; senators serve for life; president elected by electors.')">
                <strong>Aristocratic System</strong><br>
                <span style="font-size: 0.9em;">Only freeholders can vote. Senators serve 7-9 years or for life. President elected by special electors for one long term (10+ years).</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate3', 'mixed', 'Combine democratic House with aristocratic Senate; Electoral College for President.')">
                <strong>Mixed System (Checks and Balances)</strong><br>
                <span style="font-size: 0.9em;">House elected directly by the people (2 years). Senate chosen by state legislatures (6 years). President chosen by Electoral College. Leave voting qualifications to states.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate3', 'moderate-checks', 'People elect House and President; states choose Senate; property requirements for voting.')">
                <strong>Moderate Checks on Democracy</strong><br>
                <span style="font-size: 0.9em;">Balance: people elect House directly and President through electors. States choose Senators. Require some property to vote.</span>
            </button>

            <div id="debate3-reflection" style="display: none; margin-top: 30px;">
                <div class="parchment-box">
                    <h3>Reflection on Democracy and Checks</h3>
                    <p><strong>Reflect on this debate (minimum 200 words):</strong></p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>Why did many Founders distrust democracy?</li>
                        <li>What checks and balances were proposed to limit majority power?</li>
                        <li>How did the debate balance trust in the people with fear of mob rule?</li>
                        <li>What democratic norms were reinforced or violated in this debate?</li>
                    </ul>
                    
                    <textarea id="debate3-reflection-text" oninput="updateWordCount('debate3-reflection-text', 'debate3-word-count')"></textarea>
                    <div class="word-count" id="debate3-word-count">Word count: 0 / 200 minimum</div>
                </div>
                
                <button class="btn btn-primary" onclick="completeDebate('debate3')">Continue to Next Debate ‚Üí</button>
            </div>
        </div>

        <!-- DEBATE 4: BILL OF RIGHTS -->
        <div id="debate4" class="content-section">
            <h2>Debate 4: A Bill of Rights?</h2>
            
            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "The delegate from North Carolina has requested recognition to propose an important matter regarding the rights of the people."
            </div>

            <div class="parchment-box">
                <h3>The Question Before the Convention</h3>
                <p>Should the Constitution include a Bill of Rights explicitly protecting freedoms like speech, religion, press, and trial by jury?</p>
                
                <p style="margin-top: 15px;">Many state constitutions have bills of rights. But do we need one in the federal Constitution? Some say it's essential. Others say it's unnecessary or even dangerous.</p>
            </div>

            <h3 style="margin-top: 30px;">The Debate</h3>

            <div class="speech-box">
                <div class="speaker-name">Mr. Mason of Virginia:</div>
                <p>Let us lay down the general principle that right of trial needs to be prefaced by a bill of rights. This would reassure the people of the states that we do not intend to destroy their liberties. Such a bill could be drawn up in a few hours, for various states already have similar declarations that could be used as models.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Sherman of Connecticut:</div>
                <p>I am as much in favor of protecting the people rights as any man, when necessary. But the state declarations of rights are not repealed by this Constitution, and they are sufficient to protect the people.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Wilson of Pennsylvania:</div>
                <p>It appears from the example of other states, as well as from principle, that a bill of rights is neither an essential nor a necessary tool in forming a system of government since liberty may exist and be as well-protected without it. It is not only unnecessary, but also found to be impractical ‚Äî for who would be bold enough to undertake to list all the rights of the people? And when the attempt to list them is made, it must be remembered that if the list is not complete, everything not expressly mentioned will be assumed to be purposely omitted.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Colonel Hamilton of New York:</div>
                <p>A bill of rights is not only unnecessary in the proposed Constitution, but also dangerous. It would contain various exceptions to powers not granted; and, on this very account, would afford a usable pretext to claim more than were granted. For why declare that things shall not be done which there is no power to do?</p>
                
                <p style="margin-top: 15px;">What is the meaning of a declaration that "the liberty of the press shall be preserved"? What is "the liberty of the press"? Who can give it any definition that would not leave much room for evasion? I believe it to be impractical to define liberty of the press or to protect it in any constitution.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Martin of Maryland:</div>
                <p>The more this convention advances the more impressed I am of the need of not merely attempting to protect a few rights, but of forming a complete bill of rights, which would be placed at the beginning of the Constitution to serve as a barrier between the national government and the respective states and their citizens.</p>
            </div>

            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "The question is before the Convention. <span id="debate4-your-name">The delegate</span> has the floor to present their position."
            </div>

            <h3 style="margin-top: 30px;">Your Position</h3>
            <div class="parchment-box">
                <p><strong>As <span id="debate4-delegate-name">your delegate</span>, should the Constitution include a Bill of Rights?</strong></p>
            </div>

            <button class="choice-button" onclick="makeChoice('debate4', 'comprehensive-bill', 'Yes - include a comprehensive Bill of Rights in the Constitution now.')">
                <strong>Include Bill of Rights Now</strong><br>
                <span style="font-size: 0.9em;">The Constitution must include a Bill of Rights protecting freedom of speech, press, religion, trial by jury, and other essential liberties.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate4', 'no-bill-needed', 'No - a Bill of Rights is unnecessary and potentially dangerous.')">
                <strong>No Bill of Rights Needed</strong><br>
                <span style="font-size: 0.9em;">State constitutions already protect rights. A federal bill of rights is unnecessary and could be dangerous by implying the government has powers not granted.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate4', 'later-amendment', 'Leave it out now, but promise to add amendments after ratification.')">
                <strong>Add as Amendments Later</strong><br>
                <span style="font-size: 0.9em;">Don't delay ratification with this debate. Promise to add a Bill of Rights as the first amendments after the Constitution is ratified.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate4', 'limited-protections', 'Include just a few specific protections (jury trial, habeas corpus) but not a full Bill of Rights.')">
                <strong>Limited Protections Only</strong><br>
                <span style="font-size: 0.9em;">Include protection for a few essential rights (like trial by jury and habeas corpus) but don't create a comprehensive Bill of Rights.</span>
            </button>

            <div id="debate4-reflection" style="display: none; margin-top: 30px;">
                <div class="parchment-box">
                    <h3>Reflection on the Bill of Rights</h3>
                    <p><strong>Reflect on this debate (minimum 200 words):</strong></p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>Why did some Founders think a Bill of Rights was unnecessary?</li>
                        <li>Why did others think it was essential?</li>
                        <li>How does this debate relate to the balance between government power and individual liberty?</li>
                        <li>What does this tell us about the Founders' priorities?</li>
                    </ul>
                    
                    <textarea id="debate4-reflection-text" oninput="updateWordCount('debate4-reflection-text', 'debate4-word-count')"></textarea>
                    <div class="word-count" id="debate4-word-count">Word count: 0 / 200 minimum</div>
                </div>
                
                <button class="btn btn-primary" onclick="completeDebate('debate4')">Continue to Final Debate ‚Üí</button>
            </div>
        </div>

        <!-- DEBATE 5: SLAVERY -->
        <div id="debate5" class="content-section">
            <h2>Debate 5: Slavery and the Slave Trade</h2>
            
            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "Gentlemen, we now approach perhaps the most difficult question facing this Convention. The chair recognizes Mr. Martin of Maryland."
            </div>

            <div class="parchment-box">
                <h3>The Question Before the Convention</h3>
                <p>Over 600,000 enslaved people live in the United States - about 20% of the population. Virginia and Maryland have already banned further importation of slaves. But South Carolina and Georgia still import thousands from Africa.</p>
                
                <p style="margin-top: 15px;">Should the Constitution allow Congress to ban the slave trade? Should it address slavery at all? Southern delegates threaten to walk out if the slave trade is prohibited.</p>
                
                <p style="margin-top: 15px; font-weight: bold; color: #8b0000;">This may be the issue that destroys the Convention.</p>
            </div>

            <h3 style="margin-top: 30px;">The Debate</h3>

            <div class="speech-box">
                <div class="speaker-name">Mr. Martin of Maryland:</div>
                <p>Slaves (through the danger of insurrection) weaken one part of the Union, which the other parts are pledged to protect. The privilege of importing slaves is therefore unreasonable. Furthermore, it is inconsistent with the principles of the American Revolution and dishonorable to the American character to continue the slave trade. I say abolish it.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Rutledge of South Carolina:</div>
                <p>I, for one, am not afraid of slave rebellions, and would gladly exempt the other states from the obligation to protect the South against them. Religion and humanity have nothing to do with the question of importing slaves. Interest alone is the governing principle with nations. The true question at present is whether the southern states shall or shall not be parties to the Union.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Mason of Virginia:</div>
                <p>This immoral traffic in slaves started in the greed of British merchants. The British government constantly checked the attempts of Virginia to put a stop to it. The present question concerns not the slave-importing states alone, but the whole Union.</p>
                
                <p style="margin-top: 15px;">Slavery discourages arts and manufacturers. The poor hate labor when performed by slaves. Slaves prevent the immigration of whites who really enrich and strengthen a country. They produce the most terrible effect on morals. Every master of slaves is born a petty tyrant. Slaves bring the judgment of Heaven on a country. As nations cannot be rewarded or punished in the next world, they must be in this. By an inevitable chain of causes and effects, fate punishes national sins by national disasters.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">General Pinckney of South Carolina:</div>
                <p>It is my firm opinion that my and my colleagues' personal influence could not get the constitution ratified if it contained a clause prohibiting the slave trade. You have your choice. You can abolish the slave trade and lose South Carolina, Georgia, and I don't know how many other southern states, or you can remain silent on the subject and keep these states in the Union.</p>
                
                <p style="margin-top: 15px;">South Carolina and Georgia cannot do without new slaves. As to Virginia, she will gain by stopping the importations. Her slaves will rise in value and she already has more than she wants.</p>
            </div>

            <div class="speech-box">
                <div class="speaker-name">Mr. Sherman of Connecticut:</div>
                <p>I cannot say that I agree with the slave trade. I thoroughly disapprove of it. But we must remember we are writing a constitution of which the states must approve. The slave trade is now permitted to the states. The public good does not require that we take this right away from the states. So, it is best that we leave this matter as we found it.</p>
            </div>

            <div class="parliamentary-note">
                <strong>üèõÔ∏è Mr. President Washington:</strong><br>
                "This is indeed a grave matter. The chair recognizes <span id="debate5-your-name">the delegate</span>. How say you on this most difficult question?"
            </div>

            <h3 style="margin-top: 30px;">Your Position</h3>
            <div class="parchment-box">
                <p><strong>As <span id="debate5-delegate-name">your delegate</span>, what position will you take on slavery and the slave trade?</strong></p>
                <p style="margin-top: 10px; font-style: italic; color: #8b0000;">Warning: This choice may determine whether the Convention succeeds or fails.</p>
            </div>

            <button class="choice-button" onclick="makeChoice('debate5', 'abolish-now', 'Abolish the slave trade immediately and free all children born after ratification.')">
                <strong>Abolish Slavery Now</strong><br>
                <span style="font-size: 0.9em;">Prohibit the slave trade immediately. Free all enslaved children born after ratification when they reach age 25. This is the only moral position.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate5', 'ban-trade-only', 'Prohibit the importation of slaves immediately, but leave existing slavery to the states.')">
                <strong>Ban Slave Trade Immediately</strong><br>
                <span style="font-size: 0.9em;">Give Congress power to ban the slave trade immediately. Don't address slavery itself - leave that to the states.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate5', 'compromise-1808', 'Allow slave trade to continue until 1808, then give Congress power to ban it.')">
                <strong>Allow Trade Until 1808</strong><br>
                <span style="font-size: 0.9em;">Don't prohibit the slave trade before 1808. After that date, Congress can decide. Include a fugitive slave clause requiring return of escaped slaves.</span>
            </button>

            <button class="choice-button" onclick="makeChoice('debate5', 'silent', 'Say nothing about slavery or the slave trade in the Constitution.')">
                <strong>Remain Silent on Slavery</strong><br>
                <span style="font-size: 0.9em;">Leave slavery and the slave trade entirely to the states. Don't mention it in the Constitution at all.</span>
            </button>

            <div id="debate5-reflection" style="display: none; margin-top: 30px;">
                <div class="parchment-box">
                    <h3>Reflection on the Slavery Debate</h3>
                    <p><strong>Reflect on this debate (minimum 200 words):</strong></p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>Why did the Convention compromise on slavery?</li>
                        <li>What were the moral arguments made for and against slavery/slave trade?</li>
                        <li>What were the political and economic arguments?</li>
                        <li>How does this debate reflect the tension between ideals and practical politics?</li>
                        <li>What are the long-term consequences of the choices made?</li>
                    </ul>
                    
                    <textarea id="debate5-reflection-text" oninput="updateWordCount('debate5-reflection-text', 'debate5-word-count')"></textarea>
                    <div class="word-count" id="debate5-word-count">Word count: 0 / 200 minimum</div>
                </div>
                
                <button class="btn btn-primary" onclick="completeDebate('debate5')">Proceed to Final Reflection ‚Üí</button>
            </div>
        </div>

        <!-- FINAL REFLECTION -->
        <div id="final-reflection" class="content-section">
            <h2>Final Reflection</h2>
            
            <div class="parchment-box">
                <h3>The Convention Has Concluded</h3>
                <p>You have participated in all five major debates. A Constitution has been drafted based on the collective decisions of the delegates. Now it is time to reflect on your experience both as a historical delegate and as a modern student of American democracy.</p>
            </div>

            <div class="parchment-box">
                <h3>Part 1: Reflection as Your Delegate</h3>
                <p><strong>Write at least 200 words reflecting on your experience AS YOUR DELEGATE (<span id="final-delegate-name">delegate name</span>):</strong></p>
                <ul style="margin-left: 25px; margin-top: 10px;">
                    <li>What were your delegate's main goals at the Convention?</li>
                    <li>Which compromises were hardest for your delegate to accept? Why?</li>
                    <li>How did your delegate balance personal beliefs with practical politics?</li>
                    <li>Would your delegate be satisfied with the final Constitution?</li>
                </ul>
                
                <textarea id="final-reflection-delegate" oninput="updateWordCount('final-reflection-delegate', 'final-delegate-count')"></textarea>
                <div class="word-count" id="final-delegate-count">Word count: 0 / 200 minimum</div>
            </div>

            <div class="parchment-box" style="margin-top: 30px;">
                <h3>Part 2: Reflection as a Student/Citizen</h3>
                <p><strong>Write at least 200 words reflecting on your experience AS A MODERN STUDENT:</strong></p>
                <ul style="margin-left: 25px; margin-top: 10px;">
                    <li>What surprised you most about the Convention process?</li>
                    <li>How do these debates relate to current political issues?</li>
                    <li>What did you learn about the difficulty of creating a democracy?</li>
                    <li>How has this changed your understanding of the Constitution?</li>
                </ul>
                
                <textarea id="final-reflection-student" oninput="updateWordCount('final-reflection-student', 'final-student-count')"></textarea>
                <div class="word-count" id="final-student-count">Word count: 0 / 200 minimum</div>
            </div>

            <div class="parchment-box" style="margin-top: 30px;">
                <h3>Part 3: Political Norms Analysis</h3>
                <p><strong>Write at least 200 words analyzing the DEMOCRATIC NORMS you observed:</strong></p>
                <ul style="margin-left: 25px; margin-top: 10px;">
                    <li>How did delegates demonstrate (or fail to demonstrate) respect for compromise and consensus-building?</li>
                    <li>What examples of respectful disagreement did you observe?</li>
                    <li>How did parliamentary procedure support democratic deliberation?</li>
                    <li>What tensions existed between majority rule and protection of minority rights?</li>
                    <li>How were norms around representation and accountability debated?</li>
                </ul>
                
                <textarea id="final-reflection-norms" oninput="updateWordCount('final-reflection-norms', 'final-norms-count')"></textarea>
                <div class="word-count" id="final-norms-count">Word count: 0 / 200 minimum</div>
            </div>

            <button class="btn btn-primary" onclick="completeReflection()" id="complete-reflection-btn" style="margin-top: 30px;">Complete Reflection ‚Üí</button>
        </div>

        <!-- SUBMIT WORK -->
        <div id="submit" class="content-section">
            <h2>Submit Your Work</h2>
            
            <div class="parchment-box">
                <h3>Your Constitutional Convention Journey</h3>
                <p>You have completed the simulation! Review your work below, then submit it for grading.</p>
            </div>

            <div id="work-summary" class="parchment-box">
                <!-- Will be populated by JavaScript -->
            </div>

            <div class="parchment-box">
                <h3>Download and Submit Options</h3>
                <p>You can download your work as a PDF for your records, and/or submit it directly to the database.</p>
                
                <button class="btn btn-success" onclick="downloadPDF()">üìÑ Download as PDF</button>
                <button class="btn btn-primary" onclick="submitToSupabase()">üíæ Submit to Database</button>
            </div>

            <div id="submit-confirmation" style="display: none;" class="success-banner">
                <strong>‚úì Work Submitted Successfully!</strong><br>
                Your responses have been saved. You may now view the historical reveal to see what actually happened.
            </div>

            <button class="btn btn-primary" onclick="enableReveal()" id="enable-reveal-btn" style="display: none; margin-top: 20px;">Unlock Historical Reveal ‚Üí</button>
        </div>

        <!-- HISTORICAL REVEAL -->
        <div id="reveal" class="content-section">
            <div class="warning-banner">
                üîí PASSWORD PROTECTED üîí<br>
                Enter the password provided by your instructor to see what actually happened at the Convention.
            </div>

            <div class="parchment-box" style="max-width: 500px; margin: 20px auto; text-align: center;">
                <h3>Enter Password</h3>
                <input type="password" id="reveal-password" placeholder="Password provided in class">
                <button class="btn btn-danger" onclick="checkRevealPassword()">üîì Unlock Historical Reveal</button>
                <p id="password-error" style="color: #8b0000; margin-top: 10px; display: none; font-weight: bold;">‚ùå Incorrect password</p>
            </div>

            <div id="reveal-content" style="display: none;">
                <h2>What Actually Happened</h2>
                
                <div class="parchment-box">
                    <h3>Your Constitution vs. The Real Constitution</h3>
                    <div id="comparison-content">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="parchment-box">
                    <h3>Historical Outcomes</h3>
                    
                    <h4>Debate 1: Representation</h4>
                    <p><strong>What Actually Happened:</strong> The Convention adopted the Connecticut Compromise (also called the Great Compromise). Congress would have two houses: the House of Representatives with representation based on population, and the Senate with equal representation for all states (two senators each).</p>
                    <p style="margin-top: 10px;"><strong>Your Choice:</strong> <span id="reveal-debate1"></span></p>
                    
                    <h4 style="margin-top: 25px;">Debate 2: Federal Power</h4>
                    <p><strong>What Actually Happened:</strong> The Constitution created a balanced federal system. National government received enumerated powers (specifically listed), while states retained all other powers. National law became supreme, but the national government's veto power over state laws was rejected.</p>
                    <p style="margin-top: 10px;"><strong>Your Choice:</strong> <span id="reveal-debate2"></span></p>
                    
                    <h4 style="margin-top: 25px;">Debate 3: Democracy and Checks</h4>
                    <p><strong>What Actually Happened:</strong> The Constitution created a mixed system with multiple checks on democracy. The House was elected directly by the people for 2-year terms. Senators were chosen by state legislatures for 6-year terms (changed to direct election in 1913 by the 17th Amendment). The President was elected by an Electoral College for 4-year terms. Voting qualifications were left to the states.</p>
                    <p style="margin-top: 10px;"><strong>Your Choice:</strong> <span id="reveal-debate3"></span></p>
                    
                    <h4 style="margin-top: 25px;">Debate 4: Bill of Rights</h4>
                    <p><strong>What Actually Happened:</strong> The Convention decided NOT to include a Bill of Rights in the original Constitution. However, this became such a contentious issue during ratification that the Federalists promised to add one immediately. James Madison authored the Bill of Rights, which was ratified as the first 10 amendments in 1791.</p>
                    <p style="margin-top: 10px;"><strong>Your Choice:</strong> <span id="reveal-debate4"></span></p>
                    
                    <h4 style="margin-top: 25px;">Debate 5: Slavery</h4>
                    <p><strong>What Actually Happened:</strong> The Constitution allowed the slave trade to continue until 1808, after which Congress could ban it (which it did). The Constitution did not use the word "slavery" but included three clauses protecting it: the Three-Fifths Compromise (counting enslaved people as 3/5 of a person for representation), the fugitive slave clause (requiring return of escaped slaves), and the slave trade clause. This compromise would haunt the nation for decades and ultimately lead to the Civil War.</p>
                    <p style="margin-top: 10px;"><strong>Your Choice:</strong> <span id="reveal-debate5"></span></p>
                </div>

                <div class="parchment-box">
                    <h3>Reflection on Your Choices</h3>
                    <p>Compare your choices to what actually happened. Consider:</p>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li>Where did you align with the historical Convention?</li>
                        <li>Where did you differ, and why?</li>
                        <li>What does this tell you about the difficulty of compromise?</li>
                        <li>Would the Constitution you helped create have been ratified?</li>
                        <li>What are the long-term consequences of the choices the Founders made?</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Crisis Modal -->
        <div id="crisis-modal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="closeCrisis()">&times;</button>
                <div id="crisis-content"></div>
            </div>
        </div>

    </div>

    <script>
        // Initialize Supabase (only once)
        let supabaseClient;
        
        try {
            const SUPABASE_URL = 'https://bqrluqymscucfzkroyru.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxcmx1cXltc2N1Y2Z6a3JveXJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQwNDQ0OTksImV4cCI6MjA0OTYyMDQ5OX0.cKw7tOBxVsqVZ5MqvVz4k9h2RsmT_ECQqeRMMZsidTw';
            
            if (typeof window.supabase !== 'undefined') {
                supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('Supabase initialized successfully');
            } else {
                console.warn('Supabase library not loaded');
            }
        } catch (error) {
            console.error('Error initializing Supabase:', error);
        }

        // Game state
        let gameState = {
            studentName: '',
            studentEmail: '',
            selectedDelegate: null,
            choices: {},
            reflections: {},
            completed: false,
            timestamp: null
        };

        // Delegate data
        const delegates = [
            {
                id: 'madison',
                name: 'James Madison',
                state: 'Virginia',
                role: 'Father of the Constitution',
                bio: 'Age 36. Brilliant political theorist who drafted the Virginia Plan. Favors strong national government, representation by population, checks and balances. Will later co-write the Federalist Papers.',
                positions: {
                    representation: 'population',
                    federalPower: 'balanced',
                    democracy: 'mixed',
                    billOfRights: 'later-amendment',
                    slavery: 'compromise-1808'
                }
            },
            {
                id: 'hamilton',
                name: 'Alexander Hamilton',
                state: 'New York',
                role: 'Advocate for Strong Central Government',
                bio: 'Age 32. Brilliant financier and fierce nationalist. Wants a powerful executive and strong federal government. Distrusts democracy. Will later become first Secretary of the Treasury.',
                positions: {
                    representation: 'population',
                    federalPower: 'national-supreme',
                    democracy: 'aristocratic',
                    billOfRights: 'no-bill-needed',
                    slavery: 'silent'
                }
            },
            {
                id: 'franklin',
                name: 'Benjamin Franklin',
                state: 'Pennsylvania',
                role: 'Elder Statesman',
                bio: 'Age 81. Oldest delegate and most famous American. Scientist, inventor, diplomat. Favors compromise and trusts common people more than most delegates.',
                positions: {
                    representation: 'compromise',
                    federalPower: 'balanced',
                    democracy: 'full-democracy',
                    billOfRights: 'comprehensive-bill',
                    slavery: 'ban-trade-only'
                }
            },
            {
                id: 'mason',
                name: 'George Mason',
                state: 'Virginia',
                role: 'Champion of Rights',
                bio: 'Age 61. Wrote Virginia Declaration of Rights. Large slaveholder who opposes slave trade. Will refuse to sign Constitution because it lacks a Bill of Rights.',
                positions: {
                    representation: 'compromise',
                    federalPower: 'balanced',
                    democracy: 'moderate-checks',
                    billOfRights: 'comprehensive-bill',
                    slavery: 'ban-trade-only'
                }
            },
            {
                id: 'sherman',
                name: 'Roger Sherman',
                state: 'Connecticut',
                role: 'The Great Compromiser',
                bio: 'Age 66. Self-made man, former shoemaker. Author of Connecticut Compromise. Only person to sign Declaration, Articles, and Constitution. Favors practical solutions.',
                positions: {
                    representation: 'compromise',
                    federalPower: 'balanced',
                    democracy: 'mixed',
                    billOfRights: 'no-bill-needed',
                    slavery: 'silent'
                }
            },
            {
                id: 'morris',
                name: 'Gouverneur Morris',
                state: 'Pennsylvania',
                role: 'Writer of the Constitution',
                bio: 'Age 35. Brilliant writer who will pen final draft. Aristocratic and witty. Opposes slavery morally. Wants strong executive elected by the people.',
                positions: {
                    representation: 'population',
                    federalPower: 'national-supreme',
                    democracy: 'moderate-checks',
                    billOfRights: 'no-bill-needed',
                    slavery: 'ban-trade-only'
                }
            }
        ];

        // Initialize game
        window.startConvention = function() {
            const name = document.getElementById('student-name').value.trim();
            const email = document.getElementById('student-email').value.trim();
            
            if (!name || !email) {
                alert('Please enter your name and email before beginning.');
                return;
            }
            
            if (!email.includes('@my.yosemite.edu')) {
                alert('Please use your @my.yosemite.edu email address.');
                return;
            }
            
            gameState.studentName = name;
            gameState.studentEmail = email;
            gameState.timestamp = new Date().toISOString();
            
            // Show progress tracker
            document.getElementById('progress-tracker').style.display = 'flex';
            document.getElementById('progress-intro').classList.add('completed');
            
            // Load delegates
            loadDelegates();
            
            // Enable delegate selection tab
            document.getElementById('tab-delegates').disabled = false;
            showTab('delegates');
        }

        function loadDelegates() {
            const grid = document.getElementById('delegate-grid');
            grid.innerHTML = '';
            
            delegates.forEach(delegate => {
                const card = document.createElement('div');
                card.className = 'delegate-card';
                card.onclick = () => selectDelegate(delegate.id);
                card.innerHTML = `
                    <h3>${delegate.name}</h3>
                    <div class="delegate-role">${delegate.role}</div>
                    <p><strong>${delegate.state}</strong></p>
                    <p style="margin-top: 10px; font-size: 0.95em;">${delegate.bio}</p>
                `;
                card.id = `delegate-${delegate.id}`;
                grid.appendChild(card);
            });
        }

        window.selectDelegate = function(delegateId) {
            // Remove previous selection
            document.querySelectorAll('.delegate-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add new selection
            document.getElementById(`delegate-${delegateId}`).classList.add('selected');
            gameState.selectedDelegate = delegateId;
            
            // Show confirm button
            document.getElementById('confirm-delegate-btn').style.display = 'block';
        }

        window.confirmDelegate = function() {
            if (!gameState.selectedDelegate) {
                alert('Please select a delegate first.');
                return;
            }
            
            const delegate = delegates.find(d => d.id === gameState.selectedDelegate);
            
            // Update all delegate name placeholders
            document.querySelectorAll('[id^="debate"][id$="-delegate-name"]').forEach(el => {
                el.textContent = delegate.name;
            });
            document.querySelectorAll('[id^="debate"][id$="-your-name"]').forEach(el => {
                el.textContent = `${delegate.name} of ${delegate.state}`;
            });
            document.getElementById('final-delegate-name').textContent = delegate.name;
            
            document.getElementById('progress-delegate').classList.add('completed');
            document.getElementById('tab-debate1').disabled = false;
            showTab('debate1');
        }

        window.showTab = function(tabId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(tabId).classList.add('active');
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        window.makeChoice = function(debate, choice, description) {
            // Remove previous selection
            const buttons = document.querySelectorAll(`#${debate} .choice-button`);
            buttons.forEach(btn => btn.classList.remove('selected'));
            
            // Add new selection
            event.target.classList.add('selected');
            
            // Save choice
            gameState.choices[debate] = {
                choice: choice,
                description: description,
                timestamp: new Date().toISOString()
            };
            
            // Show reflection section
            document.getElementById(`${debate}-reflection`).style.display = 'block';
            
            // Check for crisis
            checkForCrisis(debate, choice);
        }

        function checkForCrisis(debate, choice) {
            // Add crisis logic based on extreme choices
            let crisis = null;
            
            if (debate === 'debate1' && (choice === 'population' || choice === 'states')) {
                crisis = {
                    title: '‚ö†Ô∏è CONVENTION CRISIS ‚ö†Ô∏è',
                    message: 'Your extreme position has caused several delegates to threaten to walk out! Small states fear domination (if population) or large states refuse to accept (if equal states). The Convention is on the brink of collapse.',
                    warning: 'Consider revisiting your choice. History shows that compromise was essential to success.'
                };
            }
            
            if (debate === 'debate5' && choice === 'abolish-now') {
                crisis = {
                    title: 'üö® SOUTHERN STATES WALK OUT üö®',
                    message: 'South Carolina and Georgia delegates have left the Convention! They refuse to join any union that abolishes slavery. The Convention has failed. The United States will not have a Constitution.',
                    warning: 'The simulation ends here. Extreme moral positions, however justified, sometimes have serious political consequences.'
                };
            }
            
            if (crisis) {
                showCrisis(crisis);
            }
        }

        function showCrisis(crisis) {
            const modal = document.getElementById('crisis-modal');
            const content = document.getElementById('crisis-content');
            
            content.innerHTML = `
                <div class="crisis-banner">${crisis.title}</div>
                <div class="parchment-box">
                    <h3>What Happened</h3>
                    <p>${crisis.message}</p>
                    <p style="margin-top: 15px; font-weight: bold;">${crisis.warning}</p>
                </div>
                <button class="btn btn-primary" onclick="closeCrisis()">Acknowledge</button>
            `;
            
            modal.classList.add('active');
        }

        window.closeCrisis = function() {
            document.getElementById('crisis-modal').classList.remove('active');
        }

        window.updateWordCount = function(textareaId, countId) {
            const textarea = document.getElementById(textareaId);
            const countDiv = document.getElementById(countId);
            const words = textarea.value.trim().split(/\s+/).filter(w => w.length > 0).length;
            
            countDiv.textContent = `Word count: ${words} / 200 minimum`;
            
            if (words >= 200) {
                countDiv.classList.add('sufficient');
            } else {
                countDiv.classList.remove('sufficient');
            }
        }

        window.completeDebate = function(debate) {
            const reflectionText = document.getElementById(`${debate}-reflection-text`).value.trim();
            const words = reflectionText.split(/\s+/).filter(w => w.length > 0).length;
            
            if (words < 200) {
                alert('Please write at least 200 words in your reflection before continuing.');
                return;
            }
            
            gameState.reflections[debate] = reflectionText;
            document.getElementById(`progress-${debate}`).classList.add('completed');
            
            // Enable next debate
            const debateNum = parseInt(debate.replace('debate', ''));
            if (debateNum < 5) {
                document.getElementById(`tab-debate${debateNum + 1}`).disabled = false;
                showTab(`debate${debateNum + 1}`);
            } else {
                document.getElementById('tab-final').disabled = false;
                showTab('final-reflection');
            }
        }

        window.submitToSupabase = async function() {
            try {
                if (!supabaseClient) {
                    throw new Error('Database connection not available');
                }
                
                const { data, error } = await supabaseClient
                    .from('convention_submissions')
                    .insert([{
                        student_name: gameState.studentName,
                        student_email: gameState.studentEmail,
                        delegate_chosen: gameState.selectedDelegate,
                        choices: gameState.choices,
                        reflections: gameState.reflections,
                        submitted_at: new Date().toISOString()
                    }]);
                
                if (error) throw error;
                
                document.getElementById('submit-confirmation').style.display = 'block';
                document.getElementById('enable-reveal-btn').style.display = 'block';
                alert('Your work has been submitted successfully!');
            } catch (error) {
                console.error('Error submitting:', error);
                alert('There was an error submitting your work. Please try downloading as PDF instead.');
            }
        }

        window.completeReflection = function() {
            const delegateText = document.getElementById('final-reflection-delegate').value.trim();
            const studentText = document.getElementById('final-reflection-student').value.trim();
            const normsText = document.getElementById('final-reflection-norms').value.trim();
            
            const delegateWords = delegateText.split(/\s+/).filter(w => w.length > 0).length;
            const studentWords = studentText.split(/\s+/).filter(w => w.length > 0).length;
            const normsWords = normsText.split(/\s+/).filter(w => w.length > 0).length;
            
            if (delegateWords < 200) {
                alert('Please write at least 200 words in Part 1 (Delegate Reflection).');
                return;
            }
            if (studentWords < 200) {
                alert('Please write at least 200 words in Part 2 (Student Reflection).');
                return;
            }
            if (normsWords < 200) {
                alert('Please write at least 200 words in Part 3 (Norms Analysis).');
                return;
            }
            
            gameState.reflections['final-delegate'] = delegateText;
            gameState.reflections['final-student'] = studentText;
            gameState.reflections['final-norms'] = normsText;
            
            document.getElementById('progress-final').classList.add('completed');
            document.getElementById('tab-submit').disabled = false;
            showTab('submit');
            
            // Generate work summary
            generateWorkSummary();
        }

        function generateWorkSummary() {
            const summaryDiv = document.getElementById('work-summary');
            const delegate = delegates.find(d => d.id === gameState.selectedDelegate);
            
            let html = '<h3>Your Choices Summary</h3>';
            html += `<p><strong>Delegate:</strong> ${delegate.name} of ${delegate.state}</p>`;
            html += '<ul style="margin-left: 25px; margin-top: 15px;">';
            
            for (let debate in gameState.choices) {
                html += `<li><strong>${debate.replace('debate', 'Debate ')}:</strong> ${gameState.choices[debate].description}</li>`;
            }
            
            html += '</ul>';
            html += '<p style="margin-top: 20px;"><strong>All reflections completed:</strong> ' + Object.keys(gameState.reflections).length + ' reflections written</p>';
            
            summaryDiv.innerHTML = html;
        }

        window.checkRevealPassword = function() {
            const password = document.getElementById('reveal-password').value;
            const correctPassword = 'philadelphia1787'; // Instructor can change this
            
            if (password === correctPassword) {
                document.getElementById('reveal-content').style.display = 'block';
                document.getElementById('password-error').style.display = 'none';
                
                // Populate comparison content
                populateRevealContent();
            } else {
                document.getElementById('password-error').style.display = 'block';
            }
        }

        function populateRevealContent() {
            // Show what the student chose for each debate
            for (let i = 1; i <= 5; i++) {
                const debateKey = `debate${i}`;
                if (gameState.choices[debateKey]) {
                    document.getElementById(`reveal-${debateKey}`).textContent = 
                        gameState.choices[debateKey].description;
                } else {
                    document.getElementById(`reveal-${debateKey}`).textContent = 
                        'No choice recorded';
                }
            }
        }

        window.downloadPDF = function() {
            alert('PDF download functionality requires jsPDF library to be properly loaded. Your data has been logged to console for now.');
            console.log('Game State:', gameState);
        }

        window.enableReveal = function() {
            document.getElementById('tab-reveal').disabled = false;
            showTab('reveal');
        }

        // Save state to localStorage periodically
        setInterval(() => {
            localStorage.setItem('conventionGameState', JSON.stringify(gameState));
        }, 30000);

        // Load state on page load
        window.onload = function() {
            const saved = localStorage.getItem('conventionGameState');
            if (saved) {
                const shouldRestore = confirm('Would you like to restore your previous session?');
                if (shouldRestore) {
                    gameState = JSON.parse(saved);
                    // Restore UI state
                    if (gameState.studentName) {
                        document.getElementById('student-name').value = gameState.studentName;
                        document.getElementById('student-email').value = gameState.studentEmail;
                    }
                }
            }
        };
    </script>
</body>
</html>
