<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSS AI Workshop Feedback Survey</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap');
        
        :root {
            --primary: #2c3e50;
            --primary-light: #34495e;
            --accent: #3498db;
            --accent-light: #5dade2;
            --bg: #f5f5f0;
            --surface: #ffffff;
            --text: #333;
            --text-light: #7f8c8d;
            --border: #bdc3c7;
            --success: #27ae60;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 40px 50px;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 4px 20px rgba(26, 58, 82, 0.15);
        }
        
        header h1 {
            font-family: 'Open Sans', sans-serif;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }
        
        header p {
            opacity: 0.9;
            font-size: 1.05em;
        }
        
        nav {
            background-color: var(--primary-light);
            padding: 15px;
            border-bottom: 2px solid var(--border);
            text-align: center;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            font-weight: bold;
        }
        
        nav a:hover {
            text-decoration: underline;
        }
        
        .mode-toggle {
            background: var(--surface);
            padding: 20px 30px;
            display: flex;
            gap: 15px;
            border-bottom: 2px solid var(--border);
        }
        
        .mode-toggle button {
            flex: 1;
            padding: 12px 24px;
            border: 2px solid var(--border);
            background: transparent;
            color: var(--text);
            font-family: 'Open Sans', sans-serif;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .mode-toggle button:hover {
            border-color: var(--accent);
            background: rgba(212, 132, 74, 0.05);
        }
        
        .mode-toggle button.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        .content {
            background: var(--surface);
            padding: 40px 50px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        
        .section {
            margin-bottom: 45px;
            padding-bottom: 35px;
            border-bottom: 1px solid var(--border);
        }
        
        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .section-number {
            background: var(--accent);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.95em;
        }
        
        .section h2 {
            font-family: 'Open Sans', sans-serif;
            font-size: 1.6em;
            color: var(--primary);
            font-weight: 700;
        }
        
        .question {
            margin-bottom: 25px;
        }
        
        .question-text {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
            font-size: 1.05em;
        }
        
        .likert-scale, .yes-no-scale {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .likert-option, .yes-no-option {
            flex: 1;
            min-width: 120px;
        }
        
        .likert-option input, .yes-no-option input {
            display: none;
        }
        
        .likert-option label, .yes-no-option label {
            display: block;
            padding: 12px 16px;
            text-align: center;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95em;
        }
        
        .likert-option label:hover, .yes-no-option label:hover {
            border-color: var(--accent-light);
            background: rgba(212, 132, 74, 0.05);
        }
        
        .likert-option input:checked + label, .yes-no-option input:checked + label {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        
        .checkbox-group {
            display: grid;
            gap: 10px;
        }
        
        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .checkbox-option:hover {
            border-color: var(--accent-light);
            background: rgba(212, 132, 74, 0.05);
        }
        
        .checkbox-option input:checked ~ label {
            font-weight: 600;
        }
        
        .checkbox-option input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }
        
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-size: 1em;
            resize: vertical;
            transition: border-color 0.3s ease;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .prompt-text {
            font-size: 0.9em;
            color: var(--text-light);
            font-style: italic;
            margin-top: 8px;
        }
        
        .submit-btn {
            background: var(--primary);
            color: white;
            padding: 16px 40px;
            border: none;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-weight: 600;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            margin-top: 30px;
        }
        
        .submit-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 58, 82, 0.25);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .thank-you {
            text-align: center;
            padding: 60px 20px;
        }
        
        .thank-you h2 {
            font-family: 'Open Sans', sans-serif;
            font-size: 2em;
            color: var(--success);
            margin-bottom: 15px;
        }
        
        .thank-you p {
            font-size: 1.1em;
            color: var(--text-light);
        }
        
        /* Results View Styles */
        .results-header {
            background: var(--primary);
            color: white;
            padding: 20px 30px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .results-header h3 {
            font-family: 'Open Sans', sans-serif;
            font-size: 1.4em;
            margin-bottom: 5px;
        }
        
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .chart-title {
            font-family: 'Open Sans', sans-serif;
            font-size: 1.3em;
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .response-count {
            text-align: center;
            font-size: 2.5em;
            font-family: 'Open Sans', sans-serif;
            color: var(--accent);
            font-weight: 700;
            margin: 30px 0;
        }
        
        .response-label {
            text-align: center;
            color: var(--text-light);
            font-size: 1.1em;
            margin-bottom: 40px;
        }
        
        .open-responses {
            background: var(--bg);
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .open-response-item {
            background: white;
            padding: 15px;
            border-left: 4px solid var(--accent);
            margin-bottom: 12px;
            border-radius: 4px;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        .open-response-item:last-child {
            margin-bottom: 0;
        }
        
        .no-responses {
            color: var(--text-light);
            font-style: italic;
            text-align: center;
            padding: 20px;
        }
        
        .intro-section {
            background-color: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .intro-section h2 {
            color: var(--primary);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 15px;
        }
        
        .intro-section p {
            margin-bottom: 12px;
            line-height: 1.7;
        }
        
        .intro-section p:last-child {
            margin-bottom: 0;
        }
        
        .intro-section strong {
            color: var(--primary);
        }
        
        .export-btn {
            background: var(--success);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }
        
        .export-btn:hover {
            background: #229954;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.25);
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            header, .content {
                padding: 30px 25px;
            }
            
            header h1 {
                font-size: 1.7em;
            }
            
            .likert-scale, .yes-no-scale {
                flex-direction: column;
            }
            
            .likert-option, .yes-no-option {
                min-width: 100%;
            }
            
            .mode-toggle {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>BSS AI Workshop Feedback Survey</h1>
            <p>Time to complete: ~2 minutes (Anonymous)</p>
        </header>
        
        <nav>
            <a href="index.html">Home</a>
            <a href="bss-ai-types.html">Types of AI</a>
            <a href="activities.html">Interactive Activities</a>
            <a href="blog.html">Blog</a>
        </nav>
        
        <div class="mode-toggle">
            <button id="surveyModeBtn" class="active">Take Survey</button>
            <button id="resultsModeBtn">View Results</button>
        </div>
        
        <div class="intro-section" id="introSection">
            <h2>About This Survey</h2>
            <p>Thank you for participating in the February 6, 2026 BSS AI Workshop. This brief feedback survey will help us understand what worked well and what we can improve for future conversations about AI in teaching and learning.</p>
            <p><strong>Your responses are completely anonymous.</strong> We're collecting feedback to inform follow-up discussions and potential school-level guidance. The survey should take approximately 2 minutes to complete.</p>
        </div>
        
        <!-- Survey View -->
        <div id="surveyView" class="content">
            <form id="surveyForm">
                <!-- Section 1 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">1</div>
                        <h2>Overall Experience</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">The workshop was a productive use of my time.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q1_1_sa" name="q1_1" value="Strongly Agree" required>
                                <label for="q1_1_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_1_a" name="q1_1" value="Agree">
                                <label for="q1_1_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_1_n" name="q1_1" value="Neutral">
                                <label for="q1_1_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_1_d" name="q1_1" value="Disagree">
                                <label for="q1_1_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_1_sd" name="q1_1" value="Strongly Disagree">
                                <label for="q1_1_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">The structure helped keep the conversation focused and respectful.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q1_2_sa" name="q1_2" value="Strongly Agree" required>
                                <label for="q1_2_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_2_a" name="q1_2" value="Agree">
                                <label for="q1_2_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_2_n" name="q1_2" value="Neutral">
                                <label for="q1_2_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_2_d" name="q1_2" value="Disagree">
                                <label for="q1_2_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_2_sd" name="q1_2" value="Strongly Disagree">
                                <label for="q1_2_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">I felt able to share or see faculty concerns represented.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q1_3_sa" name="q1_3" value="Strongly Agree" required>
                                <label for="q1_3_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_3_a" name="q1_3" value="Agree">
                                <label for="q1_3_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_3_n" name="q1_3" value="Neutral">
                                <label for="q1_3_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_3_d" name="q1_3" value="Disagree">
                                <label for="q1_3_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q1_3_sd" name="q1_3" value="Strongly Disagree">
                                <label for="q1_3_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 2 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">2</div>
                        <h2>Clarity & Purpose</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">The purpose of the workshop was clear.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q2_1_sa" name="q2_1" value="Strongly Agree" required>
                                <label for="q2_1_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_1_a" name="q2_1" value="Agree">
                                <label for="q2_1_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_1_n" name="q2_1" value="Neutral">
                                <label for="q2_1_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_1_d" name="q2_1" value="Disagree">
                                <label for="q2_1_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_1_sd" name="q2_1" value="Strongly Disagree">
                                <label for="q2_1_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">The distinction between individual classroom practice and school-level planning was helpful.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q2_2_sa" name="q2_2" value="Strongly Agree" required>
                                <label for="q2_2_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_2_a" name="q2_2" value="Agree">
                                <label for="q2_2_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_2_n" name="q2_2" value="Neutral">
                                <label for="q2_2_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_2_d" name="q2_2" value="Disagree">
                                <label for="q2_2_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_2_sd" name="q2_2" value="Strongly Disagree">
                                <label for="q2_2_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">The logic model activity helped move the conversation beyond surface-level concerns.</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q2_3_sa" name="q2_3" value="Strongly Agree" required>
                                <label for="q2_3_sa">Strongly Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_3_a" name="q2_3" value="Agree">
                                <label for="q2_3_a">Agree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_3_n" name="q2_3" value="Neutral">
                                <label for="q2_3_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_3_d" name="q2_3" value="Disagree">
                                <label for="q2_3_d">Disagree</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q2_3_sd" name="q2_3" value="Strongly Disagree">
                                <label for="q2_3_sd">Strongly Disagree</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 3 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">3</div>
                        <h2>Content Balance</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">Which areas do you think the workshop handled well? (Select all that apply)</div>
                        <div class="checkbox-group">
                            <div class="checkbox-option">
                                <input type="checkbox" id="q3_1_a" name="q3_1" value="Surfacing faculty concerns">
                                <label for="q3_1_a">Surfacing faculty concerns</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="q3_1_b" name="q3_1" value="Avoiding unproductive debate">
                                <label for="q3_1_b">Avoiding unproductive debate</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="q3_1_c" name="q3_1" value="Broadening conversation beyond cheating/test integrity">
                                <label for="q3_1_c">Broadening the conversation beyond cheating/test integrity</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="q3_1_d" name="q3_1" value="Focusing on teaching and learning">
                                <label for="q3_1_d">Focusing on teaching and learning</label>
                            </div>
                            <div class="checkbox-option">
                                <input type="checkbox" id="q3_1_e" name="q3_1" value="Respecting faculty autonomy">
                                <label for="q3_1_e">Respecting faculty autonomy</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">Which areas could use more attention in future conversations? (1-2 sentences)</div>
                        <textarea name="q3_2" placeholder="Your response..."></textarea>
                    </div>
                </div>
                
                <!-- Section 4 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">4</div>
                        <h2>Logic Model Activity</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">How useful was the logic model activity for thinking about AI-related challenges?</div>
                        <div class="likert-scale">
                            <div class="likert-option">
                                <input type="radio" id="q4_1_vu" name="q4_1" value="Very useful" required>
                                <label for="q4_1_vu">Very useful</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q4_1_su" name="q4_1" value="Somewhat useful">
                                <label for="q4_1_su">Somewhat useful</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q4_1_n" name="q4_1" value="Neutral">
                                <label for="q4_1_n">Neutral</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q4_1_sh" name="q4_1" value="Somewhat unhelpful">
                                <label for="q4_1_sh">Somewhat unhelpful</label>
                            </div>
                            <div class="likert-option">
                                <input type="radio" id="q4_1_nu" name="q4_1" value="Not useful">
                                <label for="q4_1_nu">Not useful</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">What, if anything, would have made this activity more useful? (Optional)</div>
                        <textarea name="q4_2" placeholder="Your response..."></textarea>
                    </div>
                </div>
                
                <!-- Section 5 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">5</div>
                        <h2>Outcomes & Next Steps</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">As a result of this workshop, do you feel clearer about the range of faculty perspectives on AI?</div>
                        <div class="yes-no-scale">
                            <div class="yes-no-option">
                                <input type="radio" id="q5_1_y" name="q5_1" value="Yes" required>
                                <label for="q5_1_y">Yes</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_1_s" name="q5_1" value="Somewhat">
                                <label for="q5_1_s">Somewhat</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_1_n" name="q5_1" value="No">
                                <label for="q5_1_n">No</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">As a result of this workshop, do you feel clearer about the kinds of problems the school may need to address?</div>
                        <div class="yes-no-scale">
                            <div class="yes-no-option">
                                <input type="radio" id="q5_2_y" name="q5_2" value="Yes" required>
                                <label for="q5_2_y">Yes</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_2_s" name="q5_2" value="Somewhat">
                                <label for="q5_2_s">Somewhat</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_2_n" name="q5_2" value="No">
                                <label for="q5_2_n">No</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">As a result of this workshop, do you feel clearer about what support or guidance might be helpful at the school level?</div>
                        <div class="yes-no-scale">
                            <div class="yes-no-option">
                                <input type="radio" id="q5_3_y" name="q5_3" value="Yes" required>
                                <label for="q5_3_y">Yes</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_3_s" name="q5_3" value="Somewhat">
                                <label for="q5_3_s">Somewhat</label>
                            </div>
                            <div class="yes-no-option">
                                <input type="radio" id="q5_3_n" name="q5_3" value="No">
                                <label for="q5_3_n">No</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Section 6 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">6</div>
                        <h2>Ideas & Suggestions</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">Are there specific ideas, concerns, or next steps you think the School of Behavioral and Social Sciences should consider regarding AI and teaching and learning? (Optional)</div>
                        <textarea name="q6_1" placeholder="Your response..."></textarea>
                        <div class="prompt-text">This can include guidance, support, resources, or issues that were not fully addressed today.</div>
                    </div>
                </div>
                
                <!-- Section 7 -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">7</div>
                        <h2>Final Check</h2>
                    </div>
                    
                    <div class="question">
                        <div class="question-text">Is there anything you wish had been handled differently in today's workshop? (Optional)</div>
                        <textarea name="q7_1" placeholder="Your response..."></textarea>
                    </div>
                </div>
                
                <button type="submit" id="submitBtn" class="submit-btn">Submit Survey</button>
            </form>
            
            <div id="thankYou" class="thank-you hidden">
                <h2>Thank You!</h2>
                <p>Your feedback has been recorded. Responses will be used to inform follow-up conversations and potential school-level guidance. No individual responses will be attributed.</p>
            </div>
        </div>
        
        <!-- Results View -->
        <div id="resultsView" class="content hidden">
            <div class="results-header">
                <h3>Survey Results Dashboard</h3>
                <p>Real-time anonymous responses</p>
            </div>
            
            <button class="export-btn" onclick="exportResultsCSV()">ðŸ“Š Export Results as CSV</button>
            
            <div class="response-count" id="totalResponses">0</div>
            <div class="response-label">Total Responses</div>
            
            <!-- Overall Experience Charts -->
            <div class="chart-container">
                <div class="chart-title">Overall Experience</div>
                <canvas id="q1Chart"></canvas>
            </div>
            
            <!-- Clarity & Purpose Charts -->
            <div class="chart-container">
                <div class="chart-title">Clarity & Purpose</div>
                <canvas id="q2Chart"></canvas>
            </div>
            
            <!-- Content Balance -->
            <div class="chart-container">
                <div class="chart-title">Content Balance - Areas Handled Well</div>
                <canvas id="q3_1Chart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">Areas Needing More Attention (Open Responses)</div>
                <div id="q3_2Responses" class="open-responses"></div>
            </div>
            
            <!-- Logic Model Activity -->
            <div class="chart-container">
                <div class="chart-title">Logic Model Activity Usefulness</div>
                <canvas id="q4Chart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">Suggestions to Improve Logic Model Activity</div>
                <div id="q4_2Responses" class="open-responses"></div>
            </div>
            
            <!-- Outcomes & Next Steps -->
            <div class="chart-container">
                <div class="chart-title">Clarity on Workshop Outcomes</div>
                <canvas id="q5Chart"></canvas>
            </div>
            
            <!-- Ideas & Suggestions -->
            <div class="chart-container">
                <div class="chart-title">Ideas, Concerns, and Next Steps</div>
                <div id="q6_1Responses" class="open-responses"></div>
            </div>
            
            <!-- Final Check -->
            <div class="chart-container">
                <div class="chart-title">What Could Be Handled Differently</div>
                <div id="q7_1Responses" class="open-responses"></div>
            </div>
        </div>
    </div>
    
    <script>
        // ===== SUPABASE CONFIGURATION =====
        const SUPABASE_URL = 'https://bqrluqymscucvbiaaeai.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxcmx1cXltc2N1Y3ZiaWFhZWFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg2Njg4MTMsImV4cCI6MjA4NDI0NDgxM30.AVOjnQe_TDoWydE2wDP1_YftU1lBkYxcPuyQeZb8Nfs';
        
        // Password for viewing results (change this to whatever you want)
        const RESULTS_PASSWORD = 'bss2026';
        
        // Initialize Supabase client
        let supabaseClient;
        try {
            if (typeof window.supabase !== 'undefined') {
                supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log('Supabase initialized successfully');
            } else {
                console.error('Supabase library not loaded from CDN');
            }
        } catch (err) {
            console.error('Error initializing Supabase:', err);
        }
        
        // ===== MODE TOGGLE =====
        const surveyModeBtn = document.getElementById('surveyModeBtn');
        const resultsModeBtn = document.getElementById('resultsModeBtn');
        const surveyView = document.getElementById('surveyView');
        const resultsView = document.getElementById('resultsView');
        
        surveyModeBtn.addEventListener('click', () => {
            surveyModeBtn.classList.add('active');
            resultsModeBtn.classList.remove('active');
            surveyView.classList.remove('hidden');
            resultsView.classList.add('hidden');
            document.getElementById('introSection').classList.remove('hidden');
        });
        
        resultsModeBtn.addEventListener('click', async () => {
            // Check password before showing results
            const savedPassword = sessionStorage.getItem('resultsPasswordVerified');
            if (savedPassword !== 'true') {
                const enteredPassword = prompt('Enter password to view results:');
                if (enteredPassword !== RESULTS_PASSWORD) {
                    alert('Incorrect password. Access denied.');
                    return;
                }
                sessionStorage.setItem('resultsPasswordVerified', 'true');
            }
            
            resultsModeBtn.classList.add('active');
            surveyModeBtn.classList.remove('active');
            resultsView.classList.remove('hidden');
            surveyView.classList.add('hidden');
            document.getElementById('introSection').classList.add('hidden');
            await loadResults();
        });
        
        // Form submission
        const form = document.getElementById('surveyForm');
        const thankYou = document.getElementById('thankYou');
        const submitBtn = document.getElementById('submitBtn');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!supabaseClient) {
                alert('Database connection not available. Please refresh the page and try again.');
                return;
            }

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            const formData = new FormData(form);
            const checkboxSelections = formData.getAll('q3_1');
            const response = {
                timestamp: new Date().toISOString(),
                // Overall Experience
                q1_1: formData.get('q1_1'),
                q1_2: formData.get('q1_2'),
                q1_3: formData.get('q1_3'),
                // Clarity & Purpose
                q2_1: formData.get('q2_1'),
                q2_2: formData.get('q2_2'),
                q2_3: formData.get('q2_3'),
                // Content Balance
                q3_1: checkboxSelections.length > 0 ? formatPostgresTextArray(checkboxSelections) : null,
                q3_1: checkboxSelections.length > 0 ? checkboxSelections : null,
                q3_2: formData.get('q3_2') || null,
                // Logic Model
                q4_1: formData.get('q4_1'),
                q4_2: formData.get('q4_2') || null,
                // Outcomes
                q5_1: formData.get('q5_1'),
                q5_2: formData.get('q5_2'),
                q5_3: formData.get('q5_3'),
                // Ideas & Suggestions
                q6_1: formData.get('q6_1') || null,
                // Final Check
                q7_1: formData.get('q7_1') || null
            };

            try {
                console.log('Submitting survey response:', response);

                // Insert into Supabase
                const { data, error } = await supabaseClient
                    .from('survey_responses')
                    .insert([response])
                    .select();

                if (error) throw error;

                console.log('Survey submitted successfully:', data);

                // Show thank you message
                form.classList.add('hidden');
                thankYou.classList.remove('hidden');

                // Reset form after delay
                setTimeout(() => {
                    form.reset();
                    form.classList.remove('hidden');
                    thankYou.classList.add('hidden');
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit Survey';
                }, 3000);

            } catch (error) {
                console.error('Error submitting survey:', error);
                alert('Error submitting survey: ' + (error.message || 'Unknown error') + '. Please try again or contact Prof. Hauselmann if the issue persists.');
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Survey';
            }
        });
        
        // Chart configurations
        const chartColors = {
            primary: '#2c3e50',
            accent: '#3498db',
            success: '#27ae60',
            palette: ['#2c3e50', '#3498db', '#34495e', '#5dade2', '#27ae60']
        };
        
        let charts = {};
        
        async function loadResults() {
            try {
                // Fetch all responses from Supabase
                const { data: responses, error } = await supabaseClient
                    .from('survey_responses')
                    .select('*')
                    .order('timestamp', { ascending: false});
                
                if (error) throw error;
                
                if (!responses || responses.length === 0) {
                    return;
                }
                
                displayResults(responses);
                
            } catch (error) {
                console.error('Error loading results:', error);
            }
        }
        
        function displayResults(responses) {
            document.getElementById('totalResponses').textContent = responses.length;
            
            // Destroy existing charts
            Object.values(charts).forEach(chart => chart.destroy());
            charts = {};
            
            // Overall Experience (Q1)
            displayLikertChart('q1Chart', responses, ['q1_1', 'q1_2', 'q1_3'], [
                'Productive use of time',
                'Structure kept conversation focused',
                'Concerns represented'
            ]);
            
            // Clarity & Purpose (Q2)
            displayLikertChart('q2Chart', responses, ['q2_1', 'q2_2', 'q2_3'], [
                'Purpose was clear',
                'Classroom vs. school distinction helpful',
                'Logic model moved beyond surface'
            ]);
            
            // Content Balance (Q3)
            displayCheckboxChart('q3_1Chart', responses, 'q3_1');
            displayOpenResponses('q3_2Responses', responses, 'q3_2');
            
            // Logic Model (Q4)
            displaySingleLikertChart('q4Chart', responses, 'q4_1', 'Usefulness Rating');
            displayOpenResponses('q4_2Responses', responses, 'q4_2');
            
            // Outcomes (Q5)
            displayYesNoChart('q5Chart', responses, ['q5_1', 'q5_2', 'q5_3'], [
                'Range of perspectives',
                'Problems to address',
                'Support/guidance needed'
            ]);
            
            // Open responses
            displayOpenResponses('q6_1Responses', responses, 'q6_1');
            displayOpenResponses('q7_1Responses', responses, 'q7_1');
        }
        
        function displayLikertChart(canvasId, responses, questions, labels) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const options = ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'];
            
            const datasets = questions.map((q, idx) => {
                const counts = options.map(opt => {
                    return responses.filter(r => r[q] === opt).length;
                });
                
                return {
                    label: labels[idx],
                    data: counts,
                    backgroundColor: chartColors.palette[idx % chartColors.palette.length],
                };
            });
            
            charts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: options,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function displaySingleLikertChart(canvasId, responses, question, label) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const options = ['Very useful', 'Somewhat useful', 'Neutral', 'Somewhat unhelpful', 'Not useful'];
            
            const counts = options.map(opt => {
                return responses.filter(r => r[question] === opt).length;
            });
            
            charts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: options,
                    datasets: [{
                        label: label,
                        data: counts,
                        backgroundColor: chartColors.accent,
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function displayYesNoChart(canvasId, responses, questions, labels) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const options = ['Yes', 'Somewhat', 'No'];
            
            const datasets = questions.map((q, idx) => {
                const counts = options.map(opt => {
                    return responses.filter(r => r[q] === opt).length;
                });
                
                return {
                    label: labels[idx],
                    data: counts,
                    backgroundColor: chartColors.palette[idx % chartColors.palette.length],
                };
            });
            
            charts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: options,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function displayCheckboxChart(canvasId, responses, question) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const allOptions = [
                'Surfacing faculty concerns',
                'Avoiding unproductive debate',
                'Broadening conversation beyond cheating/test integrity',
                'Focusing on teaching and learning',
                'Respecting faculty autonomy'
            ];
            
            const counts = allOptions.map(opt => {
                return responses.filter(r => normalizeCheckboxSelections(r[question]).includes(opt)).length;
            });
            
            charts[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: allOptions,
                    datasets: [{
                        label: 'Number of selections',
                        data: counts,
                        backgroundColor: chartColors.primary,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        function displayOpenResponses(containerId, responses, question) {
            const container = document.getElementById(containerId);
            const answers = responses
                .map(r => r[question])
                .filter(a => a && a.trim() !== '');
            
            if (answers.length === 0) {
                container.innerHTML = '<div class="no-responses">No responses yet</div>';
                return;
            }
            
            container.innerHTML = answers
                .map(answer => `<div class="open-response-item">${escapeHtml(answer)}</div>`)
                .join('');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatPostgresTextArray(values) {
            return `{${values.map(value => `"${String(value).replace(/\\/g, '\\\\').replace(/"/g, '\\"')}"`).join(',')}}`;
        }

        function normalizeCheckboxSelections(value) {
            if (!value) return [];
            if (Array.isArray(value)) return value;
            if (typeof value !== 'string') return [];

            const trimmed = value.trim();
            if (trimmed.startsWith('[')) {
                try {
                    const parsed = JSON.parse(trimmed);
                    return Array.isArray(parsed) ? parsed : [];
                } catch (error) {
                    console.warn('Unable to parse checkbox JSON:', error);
                    return [];
                }
            }

            if (trimmed.startsWith('{') && trimmed.endsWith('}')) {
                const inner = trimmed.slice(1, -1).trim();
                if (!inner) return [];
                const matches = inner.match(/("(?:[^"\\]|\\.)*"|[^,]+)/g) || [];
                return matches
                    .map(item => item.trim())
                    .filter(Boolean)
                    .map(item => {
                        if (item.startsWith('"') && item.endsWith('"')) {
                            const unescaped = item.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
                            return unescaped;
                        }
                        return item;
                    });
            }

            return [];
        }
        
        // ===== CSV EXPORT FUNCTION =====
        async function exportResultsCSV() {
            try {
                // Fetch all responses
                const { data: responses, error } = await supabaseClient
                    .from('survey_responses')
                    .select('*')
                    .order('timestamp', { ascending: true });
                
                if (error) throw error;
                
                if (!responses || responses.length === 0) {
                    alert('No responses to export yet.');
                    return;
                }
                
                // Create CSV header
                const headers = [
                    'Timestamp',
                    'Q1.1 - Productive use of time',
                    'Q1.2 - Structure kept conversation focused',
                    'Q1.3 - Concerns represented',
                    'Q2.1 - Purpose was clear',
                    'Q2.2 - Classroom vs school distinction helpful',
                    'Q2.3 - Logic model moved beyond surface',
                    'Q3.1 - Areas handled well',
                    'Q3.2 - Areas needing more attention',
                    'Q4.1 - Logic model usefulness',
                    'Q4.2 - Logic model improvement suggestions',
                    'Q5.1 - Clarity on range of perspectives',
                    'Q5.2 - Clarity on problems to address',
                    'Q5.3 - Clarity on support/guidance',
                    'Q6.1 - Ideas, concerns, next steps',
                    'Q7.1 - What could be handled differently'
                ];
                
                // Create CSV rows
                const rows = responses.map(r => {
                    return [
                        r.timestamp,
                        escapeCSV(r.q1_1),
                        escapeCSV(r.q1_2),
                        escapeCSV(r.q1_3),
                        escapeCSV(r.q2_1),
                        escapeCSV(r.q2_2),
                        escapeCSV(r.q2_3),
                        escapeCSV(normalizeCheckboxSelections(r.q3_1).join('; ')),
                        escapeCSV(r.q3_2),
                        escapeCSV(r.q4_1),
                        escapeCSV(r.q4_2),
                        escapeCSV(r.q5_1),
                        escapeCSV(r.q5_2),
                        escapeCSV(r.q5_3),
                        escapeCSV(r.q6_1),
                        escapeCSV(r.q7_1)
                    ].join(',');
                });
                
                // Combine header and rows
                const csv = [headers.join(','), ...rows].join('\n');
                
                // Create download
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                const date = new Date().toISOString().split('T')[0];
                link.setAttribute('href', url);
                link.setAttribute('download', `BSS_AI_Survey_Results_${date}.csv`);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
            } catch (error) {
                console.error('Export error:', error);
                alert('Error exporting results. Please try again.');
            }
        }
        
        function escapeCSV(value) {
            if (!value) return '';
            const str = String(value);
            // Escape quotes and wrap in quotes if contains comma, quote, or newline
            if (str.includes(',') || str.includes('"') || str.includes('\n')) {
                return '"' + str.replace(/"/g, '""') + '"';
            }
            return str;
        }
    </script>
    
    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: var(--text-light); border-top: 1px solid var(--border);">
        <p>Prof. Hauselmann | hauselmannh@yosemite.edu | FND 120K | profhauselmann.org</p>
    </footer>
</body>
</html>
